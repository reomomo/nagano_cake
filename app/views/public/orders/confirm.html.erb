<!--タイトル-->
<div class="container">
  <div class="row mb-4">
    <div class="col-md-3 offset-1">
      <h5 class="bg-gray px-1 text-center">注文情報確認</h5>
    </div>
  </div>

<!--注文情報確認-->
  <div class="row">
    <div class="col-md-9 align-self-start">
      <table class="table">
        <tr class="bg-gray">
          <th class="border border-dark">商品名</th>
          <th class="border border-dark">単価（税込）</th>
          <th class="border border-dark">数量</th>
          <th class="border border-dark">小計</th>
        </tr>
        <% @cart_items.each do |cart_item| %>
        <tr>
          <td class="border border-dark">
            <div class="row">
              <div class="col-md-3">
                <%= image_tag cart_item.item.get_image(30,30) %>
              </div>
              <div class="col-md-9">
                <%= cart_item.item.name %>
              </div>
            </div>
          </td>
          <td class="border border-dark"><%= cart_item.item.with_tax_price.to_s(:delimited)  %></td>
          <td class="border border-dark"><%= cart_item.amount %></td>
          <td class="border border-dark"><%= cart_item.subtotal.to_s(:delimited) %></td>
        </tr>
        <% end %>
      </table>
    </div>

<!--送料・合計・請求金額-->
    <div class="col-md-3">
      <!--align-self-end-->
      <table>
        <tr>
          <th class="bg-gray border border-dark">送料</th>
          <td class="border border-dark">
            <%= @order.postage.to_s(:delimited) %>
          </td>
        </tr>
        <tr>
          <th class="bg-gray border border-dark">商品合計</th>
          <td class="border border-dark">
            <%= @total.to_s(:delimited) %>
          </td>
        </tr>
        <tr>
          <th class="bg-gray border border-dark">請求金額</th>
          <% @order.pay_amount = @order.postage + @total %>
          <td class="border border-dark">
            <%= @order.pay_amount.to_s(:delimited) %>
          </td>
        </tr>
      </table>
    </div>
  </div>
<!--支払方法・お届け先-->
  <div class="row">
    <div class="col-md-2 align-self-start">
      <strong>支払方法</strong>
    </div>
    <div class="col-md-10 align-self-start">
      <%= @order.payment_methods_i18n %>
    </div>
    <div class="col-md-2 align-self-start">
      <strong>お届け先</strong>

    </div>
    <div class="col-md-10 align-self-start">
      〒<%= @order.delivery_target_postal_code %><%= @order.delivery_address %><br>
      <%= @order.delivery_target_full_name %>
    </div>
  </div>
  <div class="row">
    <div class="col-md-3 align-self-center">
      <%= form_with model: @order do |f| %>
        <%= f.hidden_field :customer_id %>
        <%= f.hidden_field :delivery_target_postal_code %>
        <%= f.hidden_field :delivery_address %>
        <%= f.hidden_field :delivery_target_full_name %>
        <%= f.hidden_field :postage %>
        <%= f.hidden_field :pay_amount %>
        <%= f.hidden_field :payment_methods %>
        <%= f.hidden_field :status %>
        <%= f.submit "注文を確定する", class: "btn btn-success font-weight-bold " %>
      <% end %>
    </div>
  </div>
</div>
